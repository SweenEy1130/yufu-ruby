require 'yufu'

# Identity Provider
idProvider = ::Yufu::YufuAuth.new
idProvider.idp = "idp-07b40589-a585-40ea-9e86-979f3c652b56"
idProvider.tenent = "yufu"
idProvider.private_key_path = "/Users/zhengli/Desktop/privatekey.pem"
payload = {
  sub: "lizheng@yufuid.com",
  spid: "sp-d3ba0ab4-1256-4195-b515-8e287c8c5e49",
  stype: "email",
  aci: "Ci0rQHyfkqf5XLL8QgHoTfZoMCuaSbyGWSJbtoxIWtpi9gY9x+aGx+tmtixsFDy9EDv22rDe6SWIx0uot4fPIc8GztNhn2C90FLZ+nbr4uuJHACsSbYbYC7xSj3omuIiqoTnF8QiHFvh2fD2w6cV1hX3bXpbEec4rNqISowJC+jXfOVrTVWvFhn8nzoJA/UCJNLB9Ff1StCNm7MxrDyjjT0416F0sbXx79Ild49oY3Fd8hBxwTevTrlOGvGNlaepAhra2eknRsXBCKuyBqiEDCykl/9EdDmVN40TP7lGeKJppe0xqgGTYNTBqSv5VUocKLXbnz42uuzp0S4TKXxmGA==.1ce07519e3a8565e012621ec361f61c35b2cf39d"
}

puts idProvider.generateIDPRedirectUrl(payload)

# Service Provider
id_token = "eyJraWQiOiIxY2UwNzUxOWUzYTg1NjVlMDEyNjIxZWMzNjFmNjFjMzViMmNmMzlkIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ6aGVuZ2xpQHl1ZnVpZC5jb20iLCJyb2xlIjoiTUVNQkVSIiwiYWNpIjoiZUlDWVowTklUUmhXZG0yZVIzbU82XC9hNlpJRE9acVpaejBzQVN5eElKTzhBclI4UDNPMHR1TVQzVW9HQkxDUFlDQnVsQWVUek54XC83TlRQc0xqK1pqMXlHKzRyb1dQdFdMSDVKZU04MHNXd1JibGREbFZkTGtaQkhna2h3Q3dDcFVyNVZUUHZuSGtEK2NyV21CNDJ4ajVrYkF1aVwvZmNRWTZYZ3lsRDgwSkFJVUcxZytaTitLZkN6REtnNTE0REtLSzU0K3JRTjloejVIWWxPWFg4QXlFXC8wcHdhRWM5NGpiZ1JhMGR5eHBqVXNrWVBcLzZRREpDRTJtT2J4bXJudDJvZUQrU1ExQnVIejloZE5YNmJzZkN4aWNGRFJCUUhqb2FCNk82R3hkVjV6MUJhSFwvNk5wQ1B1eUNyRnNGY043RnhKMWs1RUQ0M2JYOHlqNnVOeUR2YU9nPT0uMWNlMDc1MTllM2E4NTY1ZTAxMjYyMWVjMzYxZjYxYzM1YjJjZjM5ZCIsInN0eXBlIjoiZW1haWwiLCJpc3MiOiJjaWRwLnNzbyIsInNwaWQiOiJzcC0zODBhN2Y3MC1kOTI1LTRhNzEtODk2Zi0zZTFiMTIzNTk3MzIiLCJzc28iOiJzdWNjZXNzIiwiY2xpZW50X2lkIjoieXVmdSIsImF1ZCI6InNwLTM4MGE3ZjcwLWQ5MjUtNGE3MS04OTZmLTNlMWIxMjM1OTczMiIsImlkcCI6ImlkcC0wN2I0MDU4OS1hNTg1LTQwZWEtOWU4Ni05NzlmM2M2NWZiNTYiLCJ0bnQiOiJZVUZVUEhBQiIsInJlZGlyZWN0X3VyaSI6Imh0dHA6XC9cL3BoYWJyaWNhdG9yLnl1ZnVpZC5jb21cL2F1dGhcL2xvZ2luXC95dWZ1Onl1ZnUuY29tXC8iLCJleHAiOjE0ODQ4OTk0MTUsImlhdCI6MTQ4NDg5OTExNSwianRpIjoiYTk2YjcyNjEtOTRkOC00NjY4LTk1NzMtZDQzYTg2YzI0YjJiIn0.PrjmqmpwuNrC5TNq0xNLroG1BTbgZJwupHBvDmiuG89BvJdbnoVuHK0DZ-fzlEQJYSPCrbL7fFcwFbWt7y5SRIiIHhKImzZWI6MNuW0aAAZIq4i9Rd1pjdWJPguWNR8a-ke3ErNRuXAIjH9HLjvytfmSJ0oS6qkEc5anmyv7CHTwcz0gGSmBcT0l8AYaviUF7K0Cit6LEChSGGzc7EHlva0QTW-A2g3qGcjpU4ZdBLDB_XTSaTKfCFa4MGjl7SAK559LFj3TOc0WmNqwbPeCXl4-q2CJxhTbxlBOHSxgeMCJj4UoU3a60B3feiDjqP6sOmEbxBQ0z2kd-KsKdU_07A"
serviceProvider = ::Yufu::YufuAuth.new
serviceProvider.public_key_path = Dir.pwd + '/public_key.pem'
puts serviceProvider.verify(id_token)